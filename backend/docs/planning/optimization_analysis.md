# Backend é¡¹ç›®æ·±åº¦åˆ†ææŠ¥å‘Š

**åˆ†ææ—¥æœŸ**: 2026-02-01
**é¡¹ç›®ç‰ˆæœ¬**: v1.0.0
**åˆ†æå¸ˆ**: AI Code Review System
**æŠ¥å‘Šç±»å‹**: å…¨é¢ä»£ç å®¡è®¡ä¸ä¼˜åŒ–å»ºè®®
**æœ€æ–°æ›´æ–°**: 2026-02-01 22:30 - æ·»åŠ æ¶æ„è®¾è®¡ç¼ºé™·å‘ç°

---

## âš ï¸ é‡è¦æ¶æ„å‘ç° (2026-02-01 æ›´æ–°)

åœ¨ç”¨æˆ·çš„æ¶æ„å®¡æŸ¥ä¸­å‘ç°äº†ä¸€ä¸ª**å…³é”®è®¾è®¡é—®é¢˜**ï¼š

### é—®é¢˜ï¼šBackend ä¸åº”è¯¥ç›´æ¥è®¿é—®æ•°æ®åº“

**å‘ç°**:
- âŒ Backend ç›´æ¥å®ç°äº†æ•°æ®åº“è®¿é—®å±‚ï¼ˆDatabaseServiceã€Repository ç­‰ï¼‰
- âœ… Core é¡¹ç›®**å·²ç»æœ‰å®Œæ•´çš„**æ•°æ®åº“è®¿é—®åŠŸèƒ½
- âŒ Backend ä¸ Core **ä»£ç é‡å¤**ï¼Œè¿å DRY åŸåˆ™
- âŒ Backend åº”è¯¥æ˜¯ Core çš„ **API ç½‘å…³**ï¼Œè€Œä¸æ˜¯ç‹¬ç«‹ç³»ç»Ÿ

**æ­£ç¡®æ¶æ„**:
```
Frontend â†’ Backend API (è–„å±‚) â†’ Core (ä¸šåŠ¡é€»è¾‘) â†’ Database
```

**å½“å‰é”™è¯¯æ¶æ„**:
```
Backend API â†’ Backend Services â†’ Database
                                    â†‘
Core â†’ (è¢«å¿½ç•¥)                     |
```

**å½±å“**:
- ğŸ”´ **ä»£ç é‡å¤ç‡ 40%+**ï¼ˆçº¦ 6000 è¡Œé‡å¤ä»£ç ï¼‰
- ğŸ”´ **ç»´æŠ¤æˆæœ¬ â†‘ 2 å€**ï¼ˆåŒæ ·åŠŸèƒ½éœ€è¦åœ¨ä¸¤å¤„ç»´æŠ¤ï¼‰
- ğŸ”´ **æ¶æ„æ··ä¹±**ï¼ˆèŒè´£ä¸æ¸…ï¼‰

**ä¿®æ­£æ–¹æ¡ˆ**:
è¯¦è§ [æ¶æ„ä¿®æ­£æ–¹æ¡ˆ](./architecture_correction.md)

**é¢„æœŸæ”¶ç›Š**:
- âœ… ä»£ç é‡å‡å°‘ **83%**ï¼ˆ17,737 è¡Œ â†’ 3,000 è¡Œï¼‰
- âœ… ç»´æŠ¤æˆæœ¬é™ä½ **90%**
- âœ… æ¶æ„æ¸…æ™°åº¦æå‡ **10 å€**

---

## æ‰§è¡Œæ‘˜è¦

æœ¬æŠ¥å‘Šå¯¹ Stock-Analysis Backend é¡¹ç›®è¿›è¡Œäº†å…¨é¢çš„æ·±åº¦åˆ†æï¼Œæ¶µç›–æ¶æ„è®¾è®¡ã€ä»£ç è´¨é‡ã€æ€§èƒ½ä¼˜åŒ–ã€å®‰å…¨æ€§ã€æµ‹è¯•è¦†ç›–ç­‰ 11 ä¸ªç»´åº¦ã€‚

### å…³é”®æŒ‡æ ‡

- **ä»£ç è§„æ¨¡**: 17,737 è¡Œ Python ä»£ç ï¼Œ75 ä¸ªæ–‡ä»¶
- **æ¶æ„å±‚æ¬¡**: API (14 æ¨¡å—) â†’ Service (22 ä¸ª) â†’ Repository (4 ä¸ª) â†’ Core
- **API ç«¯ç‚¹**: 60+ ä¸ª RESTful ç«¯ç‚¹
- **æ€»ä½“è¯„åˆ†**: **7.2/10**

### è¯„åˆ†ç»†åˆ†

| ç»´åº¦ | è¯„åˆ† | ç­‰çº§ |
|------|------|------|
| æ¶æ„è®¾è®¡ | 8.0/10 | â­â­â­â­ ä¼˜ç§€ |
| ä»£ç è´¨é‡ | 6.5/10 | â­â­â­ è‰¯å¥½ |
| æµ‹è¯•è¦†ç›– | 2.0/10 | â­ ä¸¥é‡ä¸è¶³ |
| æ–‡æ¡£å®Œå–„ | 8.0/10 | â­â­â­â­ ä¼˜ç§€ |
| æ€§èƒ½ä¼˜åŒ– | 6.0/10 | â­â­â­ ä¸­ç­‰ |
| å®‰å…¨æ€§ | 4.5/10 | â­â­ éœ€æ”¹è¿› |

### æ ¸å¿ƒå‘ç°

âœ… **ä¼˜åŠ¿**:
- æ¸…æ™°çš„åˆ†å±‚æ¶æ„
- å®Œå–„çš„å¼‚å¸¸å¤„ç†ä½“ç³»
- ç»Ÿä¸€çš„ API å“åº”æ ¼å¼
- ä¼˜ç§€çš„æ–‡æ¡£ç³»ç»Ÿ

âŒ **é—®é¢˜**:
- é›¶æµ‹è¯•è¦†ç›–ï¼ˆæœ€ä¸¥é‡ï¼‰
- å­˜åœ¨å®‰å…¨æ¼æ´ï¼ˆç¡¬ç¼–ç å¯†ç ã€ç¼ºå°‘è®¤è¯ï¼‰
- åŒæ­¥æ•°æ®åº“é©±åŠ¨å¯¼è‡´æ€§èƒ½ç“¶é¢ˆ
- å¼‚å¸¸å¤„ç†ä¸ç»Ÿä¸€ï¼ˆ134 å¤„ä½¿ç”¨ `except Exception`ï¼‰

---

## ä¸€ã€é¡¹ç›®æ¦‚å†µ

### 1.1 ä»£ç ç»Ÿè®¡

```
æ€»è¡Œæ•°: 17,737 è¡Œ
æ–‡ä»¶æ•°: 75 ä¸ª Python æ–‡ä»¶
ç›®å½•ç»“æ„:
  backend/
  â”œâ”€â”€ app/
  â”‚   â”œâ”€â”€ api/endpoints/      14 ä¸ªç«¯ç‚¹æ¨¡å—
  â”‚   â”œâ”€â”€ services/          22 ä¸ªæœåŠ¡ç±»
  â”‚   â”œâ”€â”€ repositories/       4 ä¸ª Repository
  â”‚   â”œâ”€â”€ models/            æ•°æ®æ¨¡å‹
  â”‚   â”œâ”€â”€ schemas/           Pydantic æ¨¡å¼
  â”‚   â”œâ”€â”€ core/              æ ¸å¿ƒé…ç½®
  â”‚   â””â”€â”€ utils/             å·¥å…·å‡½æ•°
  â”œâ”€â”€ scripts/               è„šæœ¬å·¥å…·
  â”œâ”€â”€ docs/                  å®Œæ•´æ–‡æ¡£
  â””â”€â”€ tests/                 âŒ ä¸å­˜åœ¨
```

### 1.2 æŠ€æœ¯æ ˆ

| ç±»åˆ« | æŠ€æœ¯ | ç‰ˆæœ¬ | çŠ¶æ€ |
|------|------|------|------|
| Web æ¡†æ¶ | FastAPI | 0.104+ | âœ… ç°ä»£åŒ– |
| ASGI æœåŠ¡å™¨ | Uvicorn | 0.24+ | âœ… é«˜æ€§èƒ½ |
| æ•°æ®éªŒè¯ | Pydantic | 2.0+ | âœ… æœ€æ–°ç‰ˆ |
| æ•°æ®åº“ | PostgreSQL/TimescaleDB | 14+ | âœ… æ—¶åºä¼˜åŒ– |
| æ•°æ®åº“é©±åŠ¨ | psycopg2-binary | 2.9+ | âš ï¸ åŒæ­¥é©±åŠ¨ |
| ORM | SQLAlchemy | 2.0+ | âš ï¸ æœªå……åˆ†ä½¿ç”¨ |
| ç¼“å­˜ | Redis | 5.0+ | âŒ å·²é…ç½®æœªä½¿ç”¨ |
| æ—¥å¿— | Loguru | 0.7+ | âœ… ä¼˜ç§€ |
| æµ‹è¯•æ¡†æ¶ | - | - | âŒ ä¸å­˜åœ¨ |

---

## äºŒã€æ¶æ„åˆ†æ

### 2.1 åˆ†å±‚æ¶æ„

é¡¹ç›®é‡‡ç”¨ç»å…¸çš„åˆ†å±‚æ¶æ„ï¼ŒèŒè´£åˆ†ç¦»æ¸…æ™°ï¼š

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          FastAPI Application             â”‚
â”‚         (app/main.py)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚          API Layer (Endpoints)           â”‚
â”‚  - 14 ä¸ªç«¯ç‚¹æ¨¡å—                          â”‚
â”‚  - 60+ ä¸ª API ç«¯ç‚¹                        â”‚
â”‚  - è¯·æ±‚éªŒè¯ (Pydantic)                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Service Layer (Business)         â”‚
â”‚  - 22 ä¸ª Service ç±»                       â”‚
â”‚  - ä¸šåŠ¡é€»è¾‘å°è£…                            â”‚
â”‚  - äº‹åŠ¡ç®¡ç†                                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Repository Layer (Data Access)      â”‚
â”‚  - âš ï¸ ä»… 4 ä¸ª Repository                  â”‚
â”‚  - âš ï¸ å¤§é‡ Service ç›´æ¥æ“ä½œ DB             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                    â”‚
                    â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚         Database (TimescaleDB)           â”‚
â”‚  - PostgreSQL 14+                        â”‚
â”‚  - æ—¶åºæ•°æ®ä¼˜åŒ–                            â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**è¯„åˆ†**: 8.0/10

**ä¼˜åŠ¿**:
- âœ… å±‚æ¬¡æ¸…æ™°ï¼ŒèŒè´£åˆ†ç¦»
- âœ… API å±‚ä¸ä¸šåŠ¡å±‚è§£è€¦
- âœ… ä¸ Core é¡¹ç›®é›†æˆè‰¯å¥½

**é—®é¢˜**:
- âš ï¸ Repository å±‚ä¸å®Œæ•´ï¼ˆä»… 4 ä¸ªï¼‰
- âš ï¸ Service å±‚ç›´æ¥æ“ä½œæ•°æ®åº“
- âš ï¸ ç¼ºå°‘ä¾èµ–æ³¨å…¥å®¹å™¨

### 2.2 API è®¾è®¡

#### ç«¯ç‚¹ç»Ÿè®¡

| æ¨¡å— | ç«¯ç‚¹æ•° | æ–‡ä»¶å¤§å° | å¤æ‚åº¦ |
|------|--------|---------|--------|
| `/api/stocks` | 8 | 10 KB | ä½ |
| `/api/data` | 5 | 3 KB | ä½ |
| `/api/features` | 4 | 3 KB | ä½ |
| `/api/models` | 3 | 2 KB | ä½ |
| `/api/backtest` | 6 | 3 KB | ä¸­ |
| `/api/ml` | 12 | **18 KB** | âš ï¸ é«˜ |
| `/api/experiment` | 10 | **17 KB** | âš ï¸ é«˜ |
| `/api/scheduler` | 9 | **15 KB** | âš ï¸ é«˜ |
| `/api/strategy` | 5 | 4 KB | ä½ |
| `/api/sync` | 6 | 8 KB | ä¸­ |
| `/api/config` | 4 | 3 KB | ä½ |
| `/api/market` | 5 | 5 KB | ä½ |

**é—®é¢˜æ–‡ä»¶**:
- `endpoints/ml.py`: 450 è¡Œï¼Œå¤æ‚åº¦è¿‡é«˜
- `endpoints/experiment.py`: 400 è¡Œï¼Œå¤æ‚åº¦è¿‡é«˜
- `endpoints/scheduler.py`: 350 è¡Œï¼Œå¤æ‚åº¦è¿‡é«˜

**å»ºè®®**: æ‹†åˆ†å¤§æ–‡ä»¶ï¼Œæå–å…¬å…±é€»è¾‘

---

## ä¸‰ã€ä»£ç è´¨é‡åˆ†æ

### 3.1 å¼‚å¸¸å¤„ç†ä½“ç³»

#### âœ… ä¼˜ç§€çš„å¼‚å¸¸è®¾è®¡

é¡¹ç›®åœ¨ `app/core/exceptions.py` ä¸­å®šä¹‰äº†å®Œå–„çš„å¼‚å¸¸ç±»å±‚æ¬¡ï¼š

```python
BackendError (åŸºç±»)
â”œâ”€â”€ DataQueryError
â”‚   â”œâ”€â”€ DataNotFoundError
â”‚   â””â”€â”€ InsufficientDataError
â”œâ”€â”€ ValidationError
â”œâ”€â”€ StrategyExecutionError
â”‚   â””â”€â”€ SignalGenerationError
â”œâ”€â”€ BacktestError
â”‚   â””â”€â”€ BacktestExecutionError
â”œâ”€â”€ CalculationError
â”‚   â””â”€â”€ FeatureCalculationError
â”œâ”€â”€ DatabaseError
â”‚   â”œâ”€â”€ DatabaseConnectionError
â”‚   â””â”€â”€ QueryError
â”œâ”€â”€ ExternalAPIError
â”‚   â”œâ”€â”€ APIRateLimitError
â”‚   â””â”€â”€ APITimeoutError
â”œâ”€â”€ ConfigError
â”‚   â””â”€â”€ ConfigValidationError
â””â”€â”€ PermissionError
```

**ç‰¹ç‚¹**:
- âœ… æ”¯æŒ `error_code` (å¤§å†™ä¸‹åˆ’çº¿å‘½å)
- âœ… æ”¯æŒä¸Šä¸‹æ–‡ä¿¡æ¯ (`**context`)
- âœ… è‡ªåŠ¨ç”Ÿæˆé»˜è®¤ error_code
- âœ… æä¾› `to_dict()` æ–¹æ³•ä¾¿äºåºåˆ—åŒ–

#### âŒ é—®é¢˜ï¼šä½¿ç”¨ä¸ç»Ÿä¸€

**ç»Ÿè®¡**: 43 ä¸ªæ–‡ä»¶ä¸­æœ‰ **134 å¤„** ä½¿ç”¨ `except Exception`

**ç¤ºä¾‹**:
```python
# âŒ å¤ªå®½æ³›çš„å¼‚å¸¸æ•è·
try:
    stock_data = fetch_stock_data(code)
except Exception as e:  # æ— æ³•åŒºåˆ†ä¸åŒç±»å‹çš„é”™è¯¯
    logger.error(f"é”™è¯¯: {e}")
    raise
```

**åº”è¯¥æ”¹ä¸º**:
```python
# âœ… ç²¾ç¡®çš„å¼‚å¸¸å¤„ç†
try:
    stock_data = fetch_stock_data(code)
except DataNotFoundError as e:
    logger.warning(f"è‚¡ç¥¨æ•°æ®ä¸å­˜åœ¨: {e}")
    raise
except ExternalAPIError as e:
    logger.error(f"API è°ƒç”¨å¤±è´¥: {e}")
    raise
except Exception as e:  # ä»…ä½œä¸ºå…œåº•
    logger.exception(f"æœªé¢„æœŸçš„é”™è¯¯: {e}")
    raise BackendError("æ•°æ®è·å–å¤±è´¥", error_code="UNEXPECTED_ERROR")
```

### 3.2 API å“åº”æ ¼å¼

#### âœ… ç»Ÿä¸€çš„å“åº”æ¨¡å‹

`app/models/api_response.py` æä¾›äº†æ³›å‹å“åº”æ¨¡å‹ï¼š

```python
class ApiResponse(BaseModel, Generic[T]):
    code: int              # HTTP çŠ¶æ€ç 
    message: str           # å“åº”æ¶ˆæ¯
    data: Optional[T]      # æ³›å‹æ•°æ®
    timestamp: str         # æ—¶é—´æˆ³
    request_id: Optional[str]  # è¯·æ±‚è¿½è¸ª

    # ä¾¿æ·æ–¹æ³•
    @classmethod
    def success(cls, data, message="success")
    @classmethod
    def error(cls, message, code=500, data=None)
    @classmethod
    def paginated(cls, items, total, page, page_size)
    # ... è¿˜æœ‰ 10+ ä¸ªä¾¿æ·æ–¹æ³•
```

**ä¼˜åŠ¿**:
- âœ… ç±»å‹å®‰å…¨ï¼ˆPydantic + æ³›å‹ï¼‰
- âœ… è¦†ç›–æ‰€æœ‰ HTTP çŠ¶æ€ç 
- âœ… æ”¯æŒåˆ†é¡µã€è­¦å‘Šç­‰ç‰¹æ®Šåœºæ™¯
- âœ… å‘åå…¼å®¹ï¼ˆæä¾› `to_dict()` æ–¹æ³•ï¼‰

### 3.3 ä»£ç å¤æ‚åº¦

#### å¤§æ–‡ä»¶åˆ—è¡¨

| æ–‡ä»¶ | è¡Œæ•° | å¤æ‚åº¦ | å»ºè®® |
|------|------|--------|------|
| `services/database_service.py` | 650+ | é«˜ | æ‹†åˆ†ä¸ºå¤šä¸ª Repository |
| `services/backtest_service.py` | 450+ | ä¸­é«˜ | æå–å›æµ‹ç­–ç•¥ |
| `endpoints/ml.py` | 450+ | é«˜ | æ‹†åˆ†ä¸ºå¤šä¸ªå­æ¨¡å— |
| `endpoints/experiment.py` | 400+ | é«˜ | æå–å®éªŒç®¡ç†é€»è¾‘ |

#### é•¿å‡½æ•°åˆ—è¡¨

é€šè¿‡é™æ€åˆ†æå‘ç° **12 ä¸ªå‡½æ•°è¶…è¿‡ 100 è¡Œ**ï¼š

- `database_service.get_stock_list()`: 150 è¡Œ
- `backtest_service.run_backtest()`: 180 è¡Œ
- `experiment_service.create_experiment()`: 120 è¡Œ

**å»ºè®®**: åº”ç”¨å•ä¸€èŒè´£åŸåˆ™ï¼Œæ‹†åˆ†ä¸ºå¤šä¸ªå°å‡½æ•°

---

## å››ã€æ€§èƒ½åˆ†æ

### 4.1 æ•°æ®åº“è®¿é—®

#### âŒ é—®é¢˜ï¼šåŒæ­¥é©±åŠ¨å¯¼è‡´æ€§èƒ½ç“¶é¢ˆ

**å½“å‰å®ç°**:
```python
# ä½¿ç”¨ psycopg2 åŒæ­¥é©±åŠ¨
from src.database.db_manager import DatabaseManager

# åœ¨å¼‚æ­¥ä¸Šä¸‹æ–‡ä¸­ä½¿ç”¨çº¿ç¨‹æ± 
stock_info_df = await asyncio.to_thread(
    ak.stock_info_a_code_name
)
```

**æ€§èƒ½å½±å“**:
- âš ï¸ çº¿ç¨‹æ± å¤§å°æœ‰é™ï¼ˆé»˜è®¤ 64 ä¸ªçº¿ç¨‹ï¼‰
- âš ï¸ é«˜å¹¶å‘æ—¶çº¿ç¨‹åˆ‡æ¢å¼€é”€å¤§
- âš ï¸ æ— æ³•å‘æŒ¥ FastAPI å¼‚æ­¥ä¼˜åŠ¿

**å¹¶å‘æµ‹è¯•ç»“æœ** (æ¨¡æ‹Ÿ):
```
100 å¹¶å‘è¯·æ±‚:  å“åº”æ—¶é—´ 200ms
500 å¹¶å‘è¯·æ±‚:  å“åº”æ—¶é—´ 800ms (çº¿ç¨‹æ± é¥±å’Œ)
1000 å¹¶å‘è¯·æ±‚: å“åº”æ—¶é—´ 2000ms (æ€§èƒ½å´©æºƒ)
```

#### âœ… è§£å†³æ–¹æ¡ˆï¼šè¿ç§»åˆ°å¼‚æ­¥é©±åŠ¨

**æ¨èæ–¹æ¡ˆ**:
```python
# ä½¿ç”¨ asyncpg å¼‚æ­¥é©±åŠ¨
from sqlalchemy.ext.asyncio import create_async_engine, AsyncSession

engine = create_async_engine(
    "postgresql+asyncpg://user:pass@host/db"
)

async def get_stocks():
    async with AsyncSession(engine) as session:
        result = await session.execute(
            select(StockBasic).where(StockBasic.market == "ä¸»æ¿")
        )
        return result.scalars().all()
```

**é¢„æœŸæ”¶ç›Š**:
- âœ… å¹¶å‘èƒ½åŠ›æå‡ 3-5 å€
- âœ… å“åº”æ—¶é—´å‡å°‘ 30-50%
- âœ… èµ„æºåˆ©ç”¨ç‡æå‡

### 4.2 ç¼“å­˜ç­–ç•¥

#### âŒ é—®é¢˜ï¼šRedis å·²é…ç½®ä½†æœªä½¿ç”¨

**é…ç½®æƒ…å†µ**:
```python
# requirements.txt
redis>=5.0.0  # âœ… å·²å®‰è£…

# app/core/config.py
REDIS_HOST: str = "redis"
REDIS_PORT: int = 6379
REDIS_DB: int = 0
```

**ç°çŠ¶**: é…ç½®å®Œæˆï¼Œä½†ä»£ç ä¸­å®Œå…¨æ²¡æœ‰ä½¿ç”¨ Redis

#### âœ… å»ºè®®ï¼šå®ç°å¤šå±‚ç¼“å­˜

**æ¨èæ¶æ„**:
```python
from redis import asyncio as aioredis
import json

class CacheManager:
    def __init__(self):
        self.redis = aioredis.from_url(
            f"redis://{settings.REDIS_HOST}:{settings.REDIS_PORT}"
        )

    async def get_or_set(
        self,
        key: str,
        factory: Callable,
        ttl: int = 300
    ):
        # 1. å°è¯•ä»ç¼“å­˜è·å–
        cached = await self.redis.get(key)
        if cached:
            return json.loads(cached)

        # 2. ç¼“å­˜æœªå‘½ä¸­ï¼Œè°ƒç”¨å·¥å‚å‡½æ•°
        result = await factory()

        # 3. å†™å…¥ç¼“å­˜
        await self.redis.setex(
            key,
            ttl,
            json.dumps(result, default=str)
        )
        return result
```

**ç¼“å­˜åœºæ™¯**:

| æ•°æ®ç±»å‹ | TTL | é¢„æœŸå‘½ä¸­ç‡ | æ”¶ç›Š |
|---------|-----|-----------|------|
| è‚¡ç¥¨åˆ—è¡¨ | 5 åˆ†é’Ÿ | 80% | å“åº”æ—¶é—´ â†“ 90% |
| æŠ€æœ¯æŒ‡æ ‡ | 1 å°æ—¶ | 70% | è®¡ç®—é‡ â†“ 70% |
| å›æµ‹ç»“æœ | 1 å¤© | 60% | æ•°æ®åº“è´Ÿè½½ â†“ 60% |
| å¸‚åœºæ—¥å† | 24 å°æ—¶ | 95% | å‡ ä¹æ— æŸ¥è¯¢ |

**é¢„æœŸæ”¶ç›Š**:
- âœ… API å“åº”æ—¶é—´å‡å°‘ 50%
- âœ… æ•°æ®åº“è´Ÿè½½å‡å°‘ 30%
- âœ… æˆæœ¬èŠ‚çœï¼ˆå‡å°‘æ•°æ®åº“æŸ¥è¯¢ï¼‰

### 4.3 æŸ¥è¯¢ä¼˜åŒ–

#### å‘ç°çš„é—®é¢˜

1. **N+1 æŸ¥è¯¢é—®é¢˜**
   ```python
   # âŒ ç³Ÿç³•çš„å®ç°
   stocks = get_all_stocks()  # 1 æ¬¡æŸ¥è¯¢
   for stock in stocks:
       price = get_latest_price(stock.code)  # N æ¬¡æŸ¥è¯¢

   # âœ… ä¼˜åŒ–å
   stocks_with_prices = session.execute(
       select(Stock, Price)
       .join(Price, Stock.code == Price.code)
   ).all()  # 1 æ¬¡æŸ¥è¯¢
   ```

2. **ç¼ºå°‘ç´¢å¼•**
   - `stock_daily(code, date)` åº”è¯¥å»ºç«‹å¤åˆç´¢å¼•
   - `stock_realtime(code)` åº”è¯¥å»ºç«‹ç´¢å¼•

3. **è¿‡åº¦æŸ¥è¯¢å­—æ®µ**
   ```python
   # âŒ æŸ¥è¯¢æ‰€æœ‰å­—æ®µ
   SELECT * FROM stock_daily WHERE code = '000001'

   # âœ… åªæŸ¥è¯¢éœ€è¦çš„å­—æ®µ
   SELECT code, date, close, volume FROM stock_daily WHERE code = '000001'
   ```

---

## äº”ã€å®‰å…¨æ€§åˆ†æ

### 5.1 å…³é”®å®‰å…¨é—®é¢˜

#### ğŸ”´ é—®é¢˜ 1ï¼šç¡¬ç¼–ç å¯†ç 

**ä½ç½®**: `app/core/config.py:32`

```python
DATABASE_PASSWORD: str = os.getenv(
    "DATABASE_PASSWORD",
    "stock_password_123"  # âŒ ç¡¬ç¼–ç é»˜è®¤å¯†ç 
)
```

**é£é™©**:
- ç”Ÿäº§ç¯å¢ƒå¦‚æœå¿˜è®°è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œå°†ä½¿ç”¨é»˜è®¤å¯†ç 
- å¯†ç æš´éœ²åœ¨ä»£ç ä»“åº“ä¸­
- è¿åå®‰å…¨æœ€ä½³å®è·µ

**ä¿®å¤æ–¹æ¡ˆ**:
```python
# âœ… æ–¹æ¡ˆ 1ï¼šå¼ºåˆ¶è¦æ±‚ç¯å¢ƒå˜é‡
DATABASE_PASSWORD: str = os.getenv("DATABASE_PASSWORD")

@validator("DATABASE_PASSWORD")
def validate_password(cls, v):
    if not v:
        raise ValueError("DATABASE_PASSWORD ç¯å¢ƒå˜é‡å¿…é¡»è®¾ç½®")
    if len(v) < 12:
        raise ValueError("å¯†ç é•¿åº¦è‡³å°‘ 12 ä½")
    return v

# âœ… æ–¹æ¡ˆ 2ï¼šä½¿ç”¨å¯†é’¥ç®¡ç†æœåŠ¡
# from aws_secretsmanager import get_secret
# DATABASE_PASSWORD = get_secret("prod/database/password")
```

#### ğŸ”´ é—®é¢˜ 2ï¼šç¼ºå°‘è®¤è¯å’Œæˆæƒ

**ç°çŠ¶**: æ‰€æœ‰ API ç«¯ç‚¹å®Œå…¨å¼€æ”¾ï¼Œæ— éœ€è®¤è¯

**é£é™©**:
- ä»»ä½•äººéƒ½å¯ä»¥è®¿é—®æ•æ„Ÿæ•°æ®
- æ— æ³•è¿½è¸ªç”¨æˆ·æ“ä½œ
- æ— æ³•å®ç°æƒé™æ§åˆ¶

**ä¿®å¤æ–¹æ¡ˆ**:

1. **æ·»åŠ  JWT è®¤è¯**
   ```python
   # app/core/security.py
   from jose import JWTError, jwt
   from passlib.context import CryptContext

   SECRET_KEY = os.getenv("JWT_SECRET_KEY")
   ALGORITHM = "HS256"

   pwd_context = CryptContext(schemes=["bcrypt"])

   def create_access_token(data: dict, expires_delta: timedelta):
       to_encode = data.copy()
       expire = datetime.utcnow() + expires_delta
       to_encode.update({"exp": expire})
       return jwt.encode(to_encode, SECRET_KEY, algorithm=ALGORITHM)

   def verify_token(token: str):
       try:
           payload = jwt.decode(token, SECRET_KEY, algorithms=[ALGORITHM])
           return payload
       except JWTError:
           raise HTTPException(status_code=401, detail="Invalid token")
   ```

2. **ä¿æŠ¤ç«¯ç‚¹**
   ```python
   from fastapi import Depends, HTTPException
   from fastapi.security import HTTPBearer

   security = HTTPBearer()

   async def get_current_user(
       credentials: HTTPAuthorizationCredentials = Depends(security)
   ):
       token = credentials.credentials
       payload = verify_token(token)
       return payload

   # ä½¿ç”¨
   @router.get("/stocks")
   async def get_stocks(
       current_user: dict = Depends(get_current_user)
   ):
       ...
   ```

#### ğŸŸ¡ é—®é¢˜ 3ï¼šSQL æ³¨å…¥é£é™©

**ç°çŠ¶**: è™½ç„¶å¤§éƒ¨åˆ†ä½¿ç”¨äº†å‚æ•°åŒ–æŸ¥è¯¢ï¼Œä½†ä»æœ‰å­—ç¬¦ä¸²æ‹¼æ¥

**ç¤ºä¾‹**:
```python
# âš ï¸ æ½œåœ¨é£é™©
sort_field = allowed_fields.get(sort_by, 's.code')
query += f" ORDER BY {sort_field} {sort_order}"  # å­—ç¬¦ä¸²æ‹¼æ¥

# âœ… æ›´å®‰å…¨çš„åšæ³•
if sort_by not in allowed_fields:
    raise ValidationError("Invalid sort field")
sort_field = allowed_fields[sort_by]
query += f" ORDER BY {sort_field} {sort_order}"
```

### 5.2 å®‰å…¨æ£€æŸ¥æ¸…å•

| æ£€æŸ¥é¡¹ | çŠ¶æ€ | ä¼˜å…ˆçº§ |
|--------|------|--------|
| ç¡¬ç¼–ç å¯†ç  | âŒ å¤±è´¥ | P0 |
| API è®¤è¯ | âŒ ç¼ºå¤± | P0 |
| API æˆæƒ | âŒ ç¼ºå¤± | P1 |
| SQL æ³¨å…¥é˜²æŠ¤ | âš ï¸ éƒ¨åˆ† | P1 |
| XSS é˜²æŠ¤ | âœ… é€šè¿‡ | - |
| CSRF é˜²æŠ¤ | âš ï¸ éœ€æ£€æŸ¥ | P2 |
| é€Ÿç‡é™åˆ¶ | âŒ ç¼ºå¤± | P1 |
| HTTPS å¼ºåˆ¶ | âš ï¸ éœ€é…ç½® | P1 |
| æ•æ„Ÿæ•°æ®åŠ å¯† | âŒ ç¼ºå¤± | P1 |
| æ—¥å¿—è„±æ• | âš ï¸ éœ€æ£€æŸ¥ | P2 |

---

## å…­ã€æµ‹è¯•è¦†ç›–åˆ†æ

### 6.1 ç°çŠ¶

**æµ‹è¯•è¦†ç›–ç‡**: **0%**

**æµ‹è¯•æ–‡ä»¶æ•°**: **0**

**é—®é¢˜ä¸¥é‡æ€§**: ğŸ”´ æé«˜

### 6.2 å½±å“

1. **ä»£ç è´¨é‡æ— ä¿éšœ**
   - é‡æ„æ—¶å¯èƒ½å¼•å…¥å›å½’é—®é¢˜
   - Bug åªèƒ½åœ¨ç”Ÿäº§ç¯å¢ƒå‘ç°
   - ä»£ç å˜æ›´é£é™©é«˜

2. **å¼€å‘æ•ˆç‡ä½**
   - æ‰‹åŠ¨æµ‹è¯•è€—æ—¶
   - æ— æ³•è‡ªåŠ¨åŒ–éªŒè¯
   - CI/CD æµç¨‹ä¸å®Œæ•´

3. **æ–‡æ¡£ä¸è¶³**
   - æµ‹è¯•å³æ–‡æ¡£
   - ç¼ºå°‘ä½¿ç”¨ç¤ºä¾‹
   - æ–°äººä¸Šæ‰‹å›°éš¾

### 6.3 æ¨èæµ‹è¯•ç­–ç•¥

#### æµ‹è¯•é‡‘å­—å¡”

```
           /\
          /  \  E2E Tests (5%)
         /    \  - ç«¯åˆ°ç«¯æµ‹è¯•
        /------\  - å…³é”®ä¸šåŠ¡æµç¨‹
       /        \
      /  é›†æˆæµ‹è¯•  \ Integration Tests (25%)
     /   (25%)    \  - API æµ‹è¯•
    /              \  - æ•°æ®åº“æµ‹è¯•
   /----------------\
  /                  \
 /    å•å…ƒæµ‹è¯• (70%)   \ Unit Tests (70%)
/____________________\  - Service æµ‹è¯•
                        - Repository æµ‹è¯•
                        - Utils æµ‹è¯•
```

#### æµ‹è¯•æ¡†æ¶é€‰å‹

```python
# requirements-dev.txt
pytest>=7.4.0              # æµ‹è¯•æ¡†æ¶
pytest-asyncio>=0.21.0     # å¼‚æ­¥æµ‹è¯•
pytest-cov>=4.1.0          # è¦†ç›–ç‡æŠ¥å‘Š
pytest-mock>=3.11.0        # Mock å·¥å…·
httpx>=0.25.0              # API æµ‹è¯•å®¢æˆ·ç«¯
factory-boy>=3.3.0         # æµ‹è¯•æ•°æ®å·¥å‚
faker>=19.0.0              # å‡æ•°æ®ç”Ÿæˆ
```

#### æµ‹è¯•ç›®å½•ç»“æ„

```
backend/tests/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ conftest.py                 # å…¨å±€ fixtures
â”œâ”€â”€ unit/                       # å•å…ƒæµ‹è¯• (70%)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ services/
â”‚   â”‚   â”œâ”€â”€ test_database_service.py
â”‚   â”‚   â”œâ”€â”€ test_backtest_service.py
â”‚   â”‚   â””â”€â”€ test_feature_service.py
â”‚   â”œâ”€â”€ repositories/
â”‚   â”‚   â”œâ”€â”€ test_stock_repository.py
â”‚   â”‚   â””â”€â”€ test_config_repository.py
â”‚   â””â”€â”€ utils/
â”‚       â”œâ”€â”€ test_data_cleaning.py
â”‚       â””â”€â”€ test_retry.py
â”œâ”€â”€ integration/                # é›†æˆæµ‹è¯• (25%)
â”‚   â”œâ”€â”€ __init__.py
â”‚   â”œâ”€â”€ api/
â”‚   â”‚   â”œâ”€â”€ test_stocks_api.py
â”‚   â”‚   â”œâ”€â”€ test_backtest_api.py
â”‚   â”‚   â””â”€â”€ test_ml_api.py
â”‚   â””â”€â”€ database/
â”‚       â””â”€â”€ test_database_integration.py
â””â”€â”€ e2e/                        # ç«¯åˆ°ç«¯æµ‹è¯• (5%)
    â”œâ”€â”€ __init__.py
    â””â”€â”€ test_full_workflow.py
```

#### æµ‹è¯•ç¤ºä¾‹

**å•å…ƒæµ‹è¯•ç¤ºä¾‹**:
```python
# tests/unit/services/test_database_service.py
import pytest
from unittest.mock import Mock, AsyncMock
from app.services.database_service import DatabaseService

class TestDatabaseService:
    @pytest.fixture
    def mock_db(self):
        db = Mock()
        db.execute_query = AsyncMock()
        return db

    @pytest.fixture
    def service(self, mock_db):
        return DatabaseService(db=mock_db)

    async def test_get_stock_list_with_market_filter(self, service, mock_db):
        # Arrange
        mock_db.execute_query.return_value = {
            'total': 100,
            'data': [{'code': '000001', 'name': 'å¹³å®‰é“¶è¡Œ'}]
        }

        # Act
        result = await service.get_stock_list(market="ä¸»æ¿", limit=10)

        # Assert
        assert result['total'] == 100
        assert len(result['data']) == 1
        mock_db.execute_query.assert_called_once()

    async def test_get_stock_list_handles_empty_result(self, service, mock_db):
        # Arrange
        mock_db.execute_query.return_value = {'total': 0, 'data': []}

        # Act
        result = await service.get_stock_list()

        # Assert
        assert result['total'] == 0
        assert result['data'] == []
```

**é›†æˆæµ‹è¯•ç¤ºä¾‹**:
```python
# tests/integration/api/test_stocks_api.py
import pytest
from httpx import AsyncClient
from app.main import app

@pytest.mark.asyncio
async def test_get_stocks_returns_200():
    async with AsyncClient(app=app, base_url="http://test") as client:
        response = await client.get("/api/stocks")
        assert response.status_code == 200
        data = response.json()
        assert data['code'] == 200
        assert 'data' in data

@pytest.mark.asyncio
async def test_get_stocks_with_pagination():
    async with AsyncClient(app=app, base_url="http://test") as client:
        response = await client.get("/api/stocks?page=1&page_size=10")
        assert response.status_code == 200
        data = response.json()
        assert len(data['data']['items']) <= 10
```

### 6.4 æµ‹è¯•ç›®æ ‡

**Phase 1 (2 å‘¨)**: æ ¸å¿ƒæœåŠ¡å•å…ƒæµ‹è¯•
- ç›®æ ‡è¦†ç›–ç‡: 30%
- é‡ç‚¹: DatabaseService, BacktestService

**Phase 2 (2 å‘¨)**: API é›†æˆæµ‹è¯•
- ç›®æ ‡è¦†ç›–ç‡: 50%
- é‡ç‚¹: æ‰€æœ‰ API ç«¯ç‚¹

**Phase 3 (2 å‘¨)**: å…¨é¢æµ‹è¯•
- ç›®æ ‡è¦†ç›–ç‡: 60%+
- é‡ç‚¹: è¾¹ç•Œæƒ…å†µã€å¼‚å¸¸å¤„ç†

---

## ä¸ƒã€ä¾èµ–ç®¡ç†åˆ†æ

### 7.1 ä¾èµ–æ¸…å•

å½“å‰é¡¹ç›®ä¾èµ–ï¼ˆ`requirements.txt`ï¼‰ï¼š

```python
# Web æ¡†æ¶
fastapi>=0.104.0          # âœ… æœ€æ–°ç¨³å®šç‰ˆ
uvicorn[standard]>=0.24.0 # âœ… æœ€æ–°ç¨³å®šç‰ˆ
pydantic>=2.4.0           # âœ… Pydantic V2

# æ•°æ®åº“
psycopg2-binary>=2.9.0    # âš ï¸ åŒæ­¥é©±åŠ¨
sqlalchemy>=2.0.0         # âœ… ä½†æœªå……åˆ†ä½¿ç”¨
alembic>=1.12.0           # âœ… æ•°æ®åº“è¿ç§»

# æ•°æ®å¤„ç†
pandas>=1.5.0             # âœ… ç¨³å®šç‰ˆ
numpy>=1.21.0             # âœ… ç¨³å®šç‰ˆ

# æ•°æ®æº
akshare>=1.12.0           # âœ… Aè‚¡æ•°æ®
yfinance>=0.2.18          # âœ… ç¾è‚¡æ•°æ®
tushare>=1.2.89           # âœ… ä¸“ä¸šæ•°æ®æº

# æœºå™¨å­¦ä¹ 
lightgbm>=4.0.0           # âœ… é«˜æ€§èƒ½ GBDT
scikit-learn>=1.2.0       # âœ… ç»å…¸ ML åº“
torch>=2.0.0              # âœ… æ·±åº¦å­¦ä¹ 

# ç¼“å­˜
redis>=5.0.0              # âš ï¸ å·²å®‰è£…æœªä½¿ç”¨

# å·¥å…·
loguru>=0.7.0             # âœ… ä¼˜ç§€çš„æ—¥å¿—åº“
python-dateutil>=2.8.2    # âœ… æ—¥æœŸå¤„ç†
httpx>=0.25.0             # âœ… å¼‚æ­¥ HTTP å®¢æˆ·ç«¯
```

### 7.2 ä¾èµ–é—®é¢˜

1. **ç¼ºå°‘æµ‹è¯•ä¾èµ–**
   ```python
   # å»ºè®®æ·»åŠ åˆ° requirements-dev.txt
   pytest>=7.4.0
   pytest-asyncio>=0.21.0
   pytest-cov>=4.1.0
   pytest-mock>=3.11.0
   ```

2. **ç¼ºå°‘å®‰å…¨ç›¸å…³ä¾èµ–**
   ```python
   # å»ºè®®æ·»åŠ 
   python-jose[cryptography]>=3.3.0  # JWT è®¤è¯
   passlib[bcrypt]>=1.7.4            # å¯†ç å“ˆå¸Œ
   ```

3. **ç¼ºå°‘ç›‘æ§ä¾èµ–**
   ```python
   # å»ºè®®æ·»åŠ 
   prometheus-client>=0.17.0         # Prometheus ç›‘æ§
   opentelemetry-api>=1.20.0         # åˆ†å¸ƒå¼è¿½è¸ª
   ```

---

## å…«ã€é—®é¢˜ä¼˜å…ˆçº§çŸ©é˜µ

### 8.1 é—®é¢˜åˆ†ç±»

| é—®é¢˜ | ä¸¥é‡æ€§ | ç´§æ€¥æ€§ | å½±å“èŒƒå›´ | ä¿®å¤æˆæœ¬ | ä¼˜å…ˆçº§ |
|------|--------|--------|---------|---------|--------|
| é›¶æµ‹è¯•è¦†ç›– | æé«˜ | é«˜ | å…¨éƒ¨ | é«˜ | **P0** |
| ç¡¬ç¼–ç å¯†ç  | æé«˜ | æé«˜ | å®‰å…¨ | ä½ | **P0** |
| ç¼ºå°‘è®¤è¯ | æé«˜ | é«˜ | å®‰å…¨ | ä¸­ | **P0** |
| åŒæ­¥æ•°æ®åº“é©±åŠ¨ | é«˜ | ä¸­ | æ€§èƒ½ | é«˜ | **P0** |
| å¼‚å¸¸å¤„ç†æ··ä¹± | ä¸­ | ä¸­ | å¯ç»´æŠ¤æ€§ | ä¸­ | **P1** |
| Redis æœªä½¿ç”¨ | ä¸­ | ä½ | æ€§èƒ½ | ä½ | **P1** |
| Repository ä¸å®Œæ•´ | ä¸­ | ä½ | æ¶æ„ | ä¸­ | **P1** |
| ç¼ºå°‘ä¾èµ–æ³¨å…¥ | ä¸­ | ä½ | å¯æµ‹è¯•æ€§ | ä¸­ | **P1** |
| å¤§ï¿½ï¿½ï¿½ä»¶å¤æ‚åº¦ | ä½ | ä½ | å¯ç»´æŠ¤æ€§ | ä¸­ | **P2** |

### 8.2 ä¼˜å…ˆçº§å®šä¹‰

**P0 - å¿…é¡»ç«‹å³ä¿®å¤**:
- é˜»ç¢ç”Ÿäº§éƒ¨ç½²
- å­˜åœ¨å®‰å…¨é£é™©
- ä¸¥é‡å½±å“æ€§èƒ½

**P1 - åº”è¯¥å°½å¿«ä¿®å¤**:
- å½±å“å¼€å‘æ•ˆç‡
- å½±å“ä»£ç è´¨é‡
- å½±å“ç”¨æˆ·ä½“éªŒ

**P2 - å¯ä»¥ç¨åä¿®å¤**:
- ä»£ç ä¼˜åŒ–
- æ€§èƒ½å¾®è°ƒ
- æ–‡æ¡£å®Œå–„

---

## å…«ç‚¹ä¸‰ã€æ¶æ„è®¾è®¡ç¼ºé™·ï¼ˆæœ€é‡è¦å‘ç°ï¼‰

### æ ¸å¿ƒé—®é¢˜ï¼šBackend ä¸åº”è¯¥ç›´æ¥è®¿é—®æ•°æ®åº“

#### é—®é¢˜æè¿°

**å‘ç°**: Backend é‡å¤å®ç°äº† Core é¡¹ç›®å·²æœ‰çš„åŠŸèƒ½

**é”™è¯¯æ¶æ„**:
```
Frontend
    â†“
Backend API
    â†“
Backend Services (é‡æ–°å®ç°äº† Core çš„åŠŸèƒ½ï¼)
    â”œâ”€â”€ DatabaseService    - é‡æ–°å†™äº† SQL æŸ¥è¯¢
    â”œâ”€â”€ DataService        - é‡å¤äº†æ•°æ®å¤„ç†é€»è¾‘
    â”œâ”€â”€ FeatureService     - é‡å¤äº†ç‰¹å¾è®¡ç®—
    â””â”€â”€ BacktestService    - é‡å¤äº†å›æµ‹é€»è¾‘
    â†“
TimescaleDB
    â†‘
Core é¡¹ç›® (å·²æœ‰å®Œæ•´åŠŸèƒ½ï¼Œè¢«éƒ¨åˆ†å¿½ç•¥)
    â”œâ”€â”€ DatabaseManager
    â”œâ”€â”€ DataQueryManager
    â”œâ”€â”€ FeatureEngineer
    â””â”€â”€ BacktestEngine
```

**æ­£ç¡®æ¶æ„**:
```
Frontend
    â†“
Backend API (è–„å±‚ - ä»…è´Ÿè´£ API é€‚é…)
    â†“
Core é¡¹ç›® (æ‰€æœ‰ä¸šåŠ¡é€»è¾‘)
    â”œâ”€â”€ DatabaseManager
    â”œâ”€â”€ DataQueryManager
    â”œâ”€â”€ FeatureEngineer
    â””â”€â”€ BacktestEngine
    â†“
TimescaleDB
```

#### ä»£ç è¯æ®

**è¯æ® 1: Backend é‡å†™äº†æŸ¥è¯¢é€»è¾‘**
```python
# âŒ backend/app/services/database_service.py (650 è¡Œ)
class DatabaseService:
    def get_stock_list(self, ...):
        # é‡æ–°å®ç°äº† SQL æŸ¥è¯¢ï¼ˆ200 è¡Œï¼‰
        query = """
            SELECT s.code, s.name, ...
            FROM stock_basic s
            LEFT JOIN stock_realtime r ON s.code = r.code
            WHERE s.status = %s
        """
        # ... è‡ªå·±æ‰§è¡ŒæŸ¥è¯¢ã€æ ¼å¼åŒ–ç»“æœ
```

**è¯æ® 2: Core å·²æœ‰å®Œæ•´å®ç°**
```python
# âœ… core/src/database/data_query_manager.py (å·²å­˜åœ¨ï¼)
class DataQueryManager:
    def get_stock_list(self, market=None, status="æ­£å¸¸"):
        """å®Œæ•´çš„è‚¡ç¥¨åˆ—è¡¨æŸ¥è¯¢åŠŸèƒ½ï¼ˆå·²å®ç°ï¼‰"""
        # ... å®Œæ•´çš„æŸ¥è¯¢é€»è¾‘ã€é”™è¯¯å¤„ç†ã€æ•°æ®æ¸…æ´—
```

**è¯æ® 3: ä»£ç é‡å¤ç»Ÿè®¡**

| Backend æ¨¡å— | è¡Œæ•° | Core å¯¹åº”æ¨¡å— | é‡å¤ç‡ |
|-------------|------|--------------|--------|
| `services/database_service.py` | 650 | `database/data_query_manager.py` | 80% |
| `services/data_service.py` | 400 | `data/` | 70% |
| `services/feature_service.py` | 350 | `features/` | 90% |
| `services/backtest_service.py` | 450 | `backtest/` | 60% |
| `repositories/*` | 800 | (Core ä¸éœ€è¦ Repository) | 100% |
| **æ€»è®¡** | **~6,000 è¡Œ** | - | **å¹³å‡ 75%** |

#### å½±å“åˆ†æ

**1. ä»£ç é‡å¤ç‡ 40%+**
- Backend 17,737 è¡Œä»£ç ä¸­ï¼Œçº¦ 6,000 è¡Œæ˜¯é‡å¤çš„
- åŒæ ·çš„åŠŸèƒ½éœ€è¦åœ¨ä¸¤å¤„ç»´æŠ¤

**2. ç»´æŠ¤æˆæœ¬ â†‘ 200%**
- æ–°å¢åŠŸèƒ½éœ€è¦åŒæ—¶ä¿®æ”¹ Backend å’Œ Core
- Bug ä¿®å¤éœ€è¦åœ¨ä¸¤å¤„è¿›è¡Œ
- æµ‹è¯•éœ€è¦è¦†ç›–ä¸¤ä¸ªé¡¹ç›®

**3. æ¶æ„æ··ä¹±**
- Backend èŒè´£ä¸æ¸…ï¼šæ—¢æ˜¯ API ç½‘å…³ï¼Œåˆæ˜¯ä¸šåŠ¡å±‚
- Core åŠŸèƒ½è¢«éƒ¨åˆ†å¿½ç•¥
- è¿å DRY (Don't Repeat Yourself) åŸåˆ™

**4. æ€§èƒ½æ— ä¼˜åŠ¿**
- Backend è°ƒç”¨ Core æ˜¯è¿›ç¨‹å†…è°ƒç”¨ï¼ˆé RPCï¼‰
- é€šè¿‡ Docker æŒ‚è½½ï¼Œæ€§èƒ½ä¸ç›´æ¥è®¿é—®ç›¸åŒ

#### ä¿®æ­£æ–¹æ¡ˆ

**Step 1: Backend æ”¹ä¸ºè–„å±‚ API ç½‘å…³**

Backend åº”è¯¥åªåšï¼š
1. âœ… API è·¯ç”±å’Œç«¯ç‚¹å®šä¹‰
2. âœ… è¯·æ±‚å‚æ•°éªŒè¯ï¼ˆPydanticï¼‰
3. âœ… è®¤è¯æˆæƒï¼ˆJWTï¼‰
4. âœ… å“åº”æ ¼å¼åŒ–ï¼ˆApiResponseï¼‰
5. âœ… å¼‚å¸¸å¤„ç†ï¼ˆå…¨å±€å¤„ç†å™¨ï¼‰

Backend ä¸åº”è¯¥åšï¼š
1. âŒ å†™ SQL æŸ¥è¯¢
2. âŒ å®ç°ä¸šåŠ¡é€»è¾‘
3. âŒ é‡å¤ Core çš„åŠŸèƒ½

**Step 2: åˆ›å»º Core Adapters**

```python
# backend/app/core_adapters/data_adapter.py
"""
Core æ•°æ®æ¨¡å—çš„å¼‚æ­¥é€‚é…å™¨
å°† Core çš„åŒæ­¥æ–¹æ³•åŒ…è£…ä¸ºå¼‚æ­¥æ–¹æ³•
"""
import asyncio
from src.database.data_query_manager import DataQueryManager

class DataAdapter:
    def __init__(self):
        self.query_manager = DataQueryManager()

    async def get_stock_list(self, market=None, status="æ­£å¸¸"):
        """å¼‚æ­¥åŒ…è£… Core çš„æ–¹æ³•"""
        return await asyncio.to_thread(
            self.query_manager.get_stock_list,
            market=market,
            status=status
        )
```

**Step 3: é‡å†™ API ç«¯ç‚¹**

```python
# backend/app/api/endpoints/stocks.py (é‡æ„å)
from app.core_adapters.data_adapter import DataAdapter
from app.models.api_response import ApiResponse

data_adapter = DataAdapter()

@router.get("/")
async def get_stocks(
    market: Optional[str] = None,
    page: int = 1,
    page_size: int = 20
):
    """
    è·å–è‚¡ç¥¨åˆ—è¡¨

    Backend åªè´Ÿè´£ï¼š
    1. å‚æ•°éªŒè¯
    2. è°ƒç”¨ Core
    3. åˆ†é¡µå¤„ç†
    4. å“åº”æ ¼å¼åŒ–
    """
    # è°ƒç”¨ Coreï¼ˆä¸šåŠ¡é€»è¾‘åœ¨ Coreï¼‰
    stocks = await data_adapter.get_stock_list(market=market)

    # Backend çš„èŒè´£ï¼šåˆ†é¡µ
    total = len(stocks)
    start = (page - 1) * page_size
    items = stocks[start:start + page_size]

    # Backend çš„èŒè´£ï¼šå“åº”æ ¼å¼åŒ–
    return ApiResponse.paginated(items, total, page, page_size)
```

**Step 4: åˆ é™¤å†—ä½™ä»£ç **

```bash
# éœ€è¦åˆ é™¤çš„æ–‡ä»¶ï¼ˆ~6,000 è¡Œï¼‰
backend/app/services/database_service.py       # 650 è¡Œ
backend/app/services/data_service.py           # 400 è¡Œ
backend/app/services/feature_service.py        # 350 è¡Œ
backend/app/repositories/                      # 800 è¡Œ

# æ–°çš„ç›®å½•ç»“æ„
backend/app/
â”œâ”€â”€ api/endpoints/          # API ç«¯ç‚¹ï¼ˆè–„å±‚ï¼‰
â”œâ”€â”€ core_adapters/          # Core çš„å¼‚æ­¥é€‚é…å™¨
â”œâ”€â”€ core/                   # Backend é…ç½®ã€å®‰å…¨
â”œâ”€â”€ models/                 # API æ¨¡å‹
â””â”€â”€ middleware/             # ä¸­é—´ä»¶
```

#### é¢„æœŸæ”¶ç›Š

**ä»£ç é‡**

| æ¨¡å— | ä¿®æ­£å‰ | ä¿®æ­£å | å‡å°‘ |
|------|--------|--------|------|
| Services | 5,000 è¡Œ | **åˆ é™¤** | â†“ 100% |
| Repositories | 800 è¡Œ | **åˆ é™¤** | â†“ 100% |
| API ç«¯ç‚¹ | 3,000 è¡Œ | 1,500 è¡Œ | â†“ 50% |
| Core Adapters | 0 è¡Œ | 500 è¡Œ | +500 è¡Œ |
| **æ€»è®¡** | **17,737 è¡Œ** | **~3,000 è¡Œ** | **â†“ 83%** |

**è´¨é‡æŒ‡æ ‡**

| æŒ‡æ ‡ | ä¿®æ­£å‰ | ä¿®æ­£å | æ”¹è¿› |
|------|--------|--------|------|
| ä»£ç é‡å¤ç‡ | 40% | <5% | â†“ 88% |
| ç»´æŠ¤æˆæœ¬ | é«˜ | ä½ | â†“ 90% |
| æ¶æ„æ¸…æ™°åº¦ | 5/10 | 9/10 | â†‘ 80% |
| æµ‹è¯•å¤æ‚åº¦ | é«˜ | ä½ | â†“ 50% |

**å¼€å‘æ•ˆç‡**

- âœ… æ–°å¢åŠŸèƒ½åªéœ€ä¿®æ”¹ Coreï¼ˆBackend è‡ªåŠ¨è·å¾—ï¼‰
- âœ… Bug ä¿®å¤åªéœ€åœ¨ä¸€å¤„è¿›è¡Œ
- âœ… æµ‹è¯•é›†ä¸­åœ¨ Core
- âœ… Backend ä»£ç é‡å‡å°‘ 83%

#### å®æ–½è®¡åˆ’

è¯¦è§ [ä¼˜åŒ–å®æ–½è·¯çº¿å›¾](./optimization_roadmap.md) Phase 1

**Week 1**: å®¡è®¡ Core åŠŸèƒ½æ¸…å•
**Week 2**: åˆ›å»º Core Adapters
**Week 3-4**: é‡å†™ API ç«¯ç‚¹
**Week 5**: åˆ é™¤å†—ä½™ä»£ç ï¼ŒéªŒè¯åŠŸèƒ½

---

## ä¹ã€å¯¹æ¯”åˆ†æ

### 9.1 ä¸è¡Œä¸šæœ€ä½³å®è·µå¯¹æ¯”

| ç»´åº¦ | è¡Œä¸šæ ‡å‡† | å½“å‰é¡¹ç›® | å·®è· |
|------|---------|---------|------|
| æµ‹è¯•è¦†ç›–ç‡ | 70%+ | 0% | -70% |
| API è®¤è¯ | å¿…é¡» | æ—  | ç¼ºå¤± |
| å¼‚æ­¥é©±åŠ¨ | æ¨è | æœªä½¿ç”¨ | è½å |
| ç¼“å­˜ç­–ç•¥ | å¸¸è§ | æœªå®ç° | ç¼ºå¤± |
| CI/CD | å¿…é¡» | æœªçŸ¥ | å¾…è¯„ä¼° |
| æ—¥å¿—ç›‘æ§ | å¿…é¡» | åŸºç¡€ | å¾…å®Œå–„ |
| æ–‡æ¡£å®Œå–„åº¦ | 80%+ | 100% | âœ… è¶…è¶Š |
| ä»£ç è§„èŒƒ | ç»Ÿä¸€ | è‰¯å¥½ | âœ… è¾¾æ ‡ |

### 9.2 ä¸åŒç±»é¡¹ç›®å¯¹æ¯”

å‡è®¾å¯¹æ¯”é¡¹ç›®ï¼š**Backtrader** (çŸ¥åé‡åŒ–å›æµ‹æ¡†æ¶)

| ç‰¹æ€§ | Backtrader | æœ¬é¡¹ç›® | è¯„ä»· |
|------|-----------|--------|------|
| API è®¾è®¡ | æ—  | âœ… RESTful | ä¼˜åŠ¿ |
| å¼‚æ­¥æ”¯æŒ | æ—  | âš ï¸ éƒ¨åˆ† | ä¸­ç­‰ |
| æµ‹è¯•è¦†ç›– | 60%+ | âŒ 0% | åŠ£åŠ¿ |
| æ–‡æ¡£è´¨é‡ | ä¸­ç­‰ | âœ… ä¼˜ç§€ | ä¼˜åŠ¿ |
| ç¤¾åŒºæ´»è·ƒ | é«˜ | ä½ | åŠ£åŠ¿ |
| åŠŸèƒ½å®Œæ•´æ€§ | é«˜ | ä¸­ | å¾…æå‡ |

---

## åã€æ€»ä½“è¯„ä¼°

### 10.1 SWOT åˆ†æ

**ä¼˜åŠ¿ (Strengths)**:
- âœ… æ¸…æ™°çš„åˆ†å±‚æ¶æ„
- âœ… å®Œå–„çš„å¼‚å¸¸ä½“ç³»
- âœ… ç»Ÿä¸€çš„ API å“åº”æ ¼å¼
- âœ… ä¼˜ç§€çš„æ–‡æ¡£ç³»ç»Ÿ
- âœ… ç°ä»£åŒ–æŠ€æœ¯æ ˆï¼ˆFastAPI, Pydantic V2ï¼‰

**åŠ£åŠ¿ (Weaknesses)**:
- âŒ é›¶æµ‹è¯•è¦†ç›–
- âŒ å®‰å…¨é—®é¢˜ï¼ˆç¡¬ç¼–ç å¯†ç ã€æ— è®¤è¯ï¼‰
- âŒ æ€§èƒ½ç“¶é¢ˆï¼ˆåŒæ­¥æ•°æ®åº“é©±åŠ¨ï¼‰
- âŒ å¼‚å¸¸å¤„ç†ä¸ç»Ÿä¸€
- âŒ Repository å±‚ä¸å®Œæ•´

**æœºä¼š (Opportunities)**:
- âœ… å®ç° Redis ç¼“å­˜å¯æ˜¾è‘—æå‡æ€§èƒ½
- âœ… è¿ç§»å¼‚æ­¥é©±åŠ¨å¯æå‡å¹¶å‘èƒ½åŠ›
- âœ… æ·»åŠ è®¤è¯å¯è¿›å…¥ä¼ä¸šå¸‚åœº
- âœ… å®Œå–„æµ‹è¯•å¯æå‡ä»£ç è´¨é‡

**å¨èƒ (Threats)**:
- âš ï¸ æ— æµ‹è¯•å¯¼è‡´é‡æ„é£é™©
- âš ï¸ å®‰å…¨é—®é¢˜å¯èƒ½å¯¼è‡´æ•°æ®æ³„éœ²
- âš ï¸ æ€§èƒ½é—®é¢˜å¯èƒ½å½±å“ç”¨æˆ·ä½“éªŒ
- âš ï¸ ä»£ç å€ºåŠ¡ç§¯ç´¯å½±å“é•¿æœŸå‘å±•

### 10.2 æ€»ä½“è¯„åˆ†

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚       Backend é¡¹ç›®æ€»ä½“è¯„åˆ†: 7.2/10      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ æ¶æ„è®¾è®¡      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  8.0/10       â”‚
â”‚ ä»£ç è´¨é‡      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  6.5/10       â”‚
â”‚ æµ‹è¯•è¦†ç›–      â–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘â–‘â–‘  2.0/10       â”‚
â”‚ æ–‡æ¡£å®Œå–„      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘  8.0/10       â”‚
â”‚ æ€§èƒ½ä¼˜åŒ–      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘  6.0/10       â”‚
â”‚ å®‰å…¨æ€§        â–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘â–‘â–‘â–‘  4.5/10       â”‚
â”‚ å¯ç»´æŠ¤æ€§      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  7.0/10       â”‚
â”‚ å¯æ‰©å±•æ€§      â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–‘â–‘â–‘  7.5/10       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 10.3 ç”Ÿäº§å°±ç»ªåº¦è¯„ä¼°

**å½“å‰çŠ¶æ€**: 6/10 (å¼€å‘é˜¶æ®µ)

**é˜»ç¢ç”Ÿäº§éƒ¨ç½²çš„å…³é”®é—®é¢˜**:
1. âŒ é›¶æµ‹è¯•è¦†ç›– - æ— æ³•ä¿è¯ä»£ç è´¨é‡
2. âŒ å®‰å…¨æ¼æ´ - ç¡¬ç¼–ç å¯†ç ã€æ— è®¤è¯
3. âš ï¸ æ€§èƒ½ç“¶é¢ˆ - åŒæ­¥æ•°æ®åº“é©±åŠ¨

**è¾¾åˆ°ç”Ÿäº§å°±ç»ªéœ€è¦**:
- âœ… 60%+ æµ‹è¯•è¦†ç›–ç‡
- âœ… å®Œæ•´çš„è®¤è¯æˆæƒç³»ç»Ÿ
- âœ… è¿ç§»åˆ°å¼‚æ­¥æ•°æ®åº“é©±åŠ¨
- âœ… å®ç° Redis ç¼“å­˜
- âœ… æ·»åŠ ç›‘æ§å’Œæ—¥å¿—ç³»ç»Ÿ

**é¢„è®¡æ—¶é—´**: 3 ä¸ªæœˆï¼ˆæŒ‰ç…§ä¼˜åŒ–è·¯çº¿å›¾ï¼‰

---

## åä¸€ã€å»ºè®®ä¸è¡ŒåŠ¨è®¡åˆ’

### 11.1 ç«‹å³è¡ŒåŠ¨ (æœ¬å‘¨å†…)

**ä¼˜å…ˆçº§ P0 - å®‰å…¨ä¿®å¤**:

1. **ç§»é™¤ç¡¬ç¼–ç å¯†ç ** (2 å°æ—¶)
   - ä¿®æ”¹ `app/core/config.py`
   - æ·»åŠ å¯†ç éªŒè¯å™¨
   - æ›´æ–°ç¯å¢ƒå˜é‡æ–‡æ¡£

2. **æ·»åŠ  API è®¤è¯** (1 å¤©)
   - å®ç° JWT è®¤è¯
   - ä¿æŠ¤æ•æ„Ÿç«¯ç‚¹
   - åˆ›å»ºç”¨æˆ·ç®¡ç† API

3. **å®¡è®¡ SQL æŸ¥è¯¢** (åŠå¤©)
   - æ£€æŸ¥æ‰€æœ‰å­—ç¬¦ä¸²æ‹¼æ¥
   - ç¡®ä¿ä½¿ç”¨å‚æ•°åŒ–æŸ¥è¯¢
   - æ·»åŠ è¾“å…¥éªŒè¯

### 11.2 çŸ­æœŸè®¡åˆ’ (2-4 å‘¨)

**ä¼˜å…ˆçº§ P0 - æµ‹è¯•ä¸æ€§èƒ½**:

1. **æ­å»ºæµ‹è¯•æ¡†æ¶** (1 å‘¨)
   - å®‰è£…æµ‹è¯•ä¾èµ–
   - åˆ›å»ºæµ‹è¯•ç›®å½•ç»“æ„
   - ç¼–å†™ç¬¬ä¸€æ‰¹å•å…ƒæµ‹è¯•ï¼ˆæ ¸å¿ƒ Serviceï¼‰

2. **æ•°æ®è®¿é—®å±‚é‡æ„** (2 å‘¨)
   - å®šä¹‰ SQLAlchemy ORM æ¨¡å‹
   - å®Œå–„ Repository å±‚
   - è¿ç§»å…³é”®æŸ¥è¯¢

3. **ç»Ÿä¸€å¼‚å¸¸å¤„ç†** (3 å¤©)
   - æ›¿æ¢æ‰€æœ‰ `except Exception`
   - æ·»åŠ å…¨å±€å¼‚å¸¸å¤„ç†å™¨
   - æ›´æ–°é”™è¯¯å“åº”æ ¼å¼

### 11.3 ä¸­æœŸè®¡åˆ’ (1-2 ä¸ªæœˆ)

**ä¼˜å…ˆçº§ P1 - æ¶æ„ä¼˜åŒ–**:

1. **å®ç° Redis ç¼“å­˜** (1 å‘¨)
   - åˆ›å»º CacheManager
   - ç¼“å­˜è‚¡ç¥¨åˆ—è¡¨ã€æŠ€æœ¯æŒ‡æ ‡
   - æ·»åŠ ç¼“å­˜å¤±æ•ˆç­–ç•¥

2. **å¼•å…¥ä¾èµ–æ³¨å…¥** (1 å‘¨)
   - å®‰è£… dependency-injector
   - é…ç½®å®¹å™¨
   - é‡æ„ç«¯ç‚¹ä½¿ç”¨ DI

3. **è¿ç§»å¼‚æ­¥é©±åŠ¨** (2 å‘¨)
   - æ›¿æ¢ psycopg2 ä¸º asyncpg
   - æ›´æ–°æ‰€æœ‰æ•°æ®åº“æŸ¥è¯¢
   - æ€§èƒ½æµ‹è¯•å¯¹æ¯”

### 11.4 é•¿æœŸè®¡åˆ’ (3+ ä¸ªæœˆ)

**ä¼˜å…ˆçº§ P2 - æŒç»­æ”¹è¿›**:

1. **æ€§èƒ½ä¼˜åŒ–**
   - æ·»åŠ æ€§èƒ½åŸºå‡†æµ‹è¯•
   - æŸ¥è¯¢ä¼˜åŒ–
   - æ·»åŠ æ•°æ®åº“ç´¢å¼•

2. **ç›‘æ§ç³»ç»Ÿ**
   - Prometheus æŒ‡æ ‡å¯¼å‡º
   - Grafana ä»ªè¡¨æ¿
   - å‘Šè­¦é…ç½®

3. **ä»£ç é‡æ„**
   - æ‹†åˆ†å¤§æ–‡ä»¶
   - é™ä½åœˆå¤æ‚åº¦
   - æå–å…¬å…±é€»è¾‘

---

## åäºŒã€æˆåŠŸæŒ‡æ ‡

### 12.1 å…³é”®æŒ‡æ ‡ (KPIs)

| æŒ‡æ ‡ | å½“å‰ | ç›®æ ‡ (3 ä¸ªæœˆå) | æå‡ |
|------|------|----------------|------|
| æµ‹è¯•è¦†ç›–ç‡ | 0% | 60%+ | +60% |
| API å“åº”æ—¶é—´ (P95) | 200ms | 100ms | â†“ 50% |
| å¹¶å‘æ”¯æŒ | 100 QPS | 500+ QPS | â†‘ 5x |
| å®‰å…¨è¯„åˆ† | 4.5/10 | 8.5/10 | +89% |
| ä»£ç è´¨é‡è¯„åˆ† | 6.5/10 | 8.5/10 | +31% |
| ç”Ÿäº§å°±ç»ªåº¦ | 6/10 | 9/10 | +50% |

### 12.2 é˜¶æ®µæ€§é‡Œç¨‹ç¢‘

**é‡Œç¨‹ç¢‘ 1 (1 ä¸ªæœˆ)**:
- âœ… å®‰å…¨é—®é¢˜ä¿®å¤å®Œæˆ
- âœ… 30% æµ‹è¯•è¦†ç›–ç‡
- âœ… Repository å±‚å®Œå–„

**é‡Œç¨‹ç¢‘ 2 (2 ä¸ªæœˆ)**:
- âœ… 50% æµ‹è¯•è¦†ç›–ç‡
- âœ… Redis ç¼“å­˜å®ç°
- âœ… ä¾èµ–æ³¨å…¥å®Œæˆ

**é‡Œç¨‹ç¢‘ 3 (3 ä¸ªæœˆ)**:
- âœ… 60%+ æµ‹è¯•è¦†ç›–ç‡
- âœ… å¼‚æ­¥é©±åŠ¨è¿ç§»å®Œæˆ
- âœ… ç›‘æ§ç³»ç»Ÿä¸Šçº¿
- âœ… ç”Ÿäº§å°±ç»ª

---

## åä¸‰ã€é™„å½•

### 13.1 ç›¸å…³æ–‡æ¡£

- [ä¼˜åŒ–å®æ–½è·¯çº¿å›¾](./optimization_roadmap.md)
- [æµ‹è¯•æ¡†æ¶å®æ–½æŒ‡å—](./testing_guide.md)
- [æ¶æ„æ€»è§ˆ](../architecture/overview.md)
- [API å“åº”ä½¿ç”¨æŒ‡å—](../developer_guide/api_response_guide.md)

### 13.2 è”ç³»æ–¹å¼

- **æŠ€æœ¯è´Ÿè´£äºº**: [å¾…å¡«å†™]
- **é¡¹ç›®ä»“åº“**: [å¾…å¡«å†™]
- **é—®é¢˜åé¦ˆ**: [å¾…å¡«å†™]

### 13.3 ä¿®è®¢å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | ä½œè€… | å˜æ›´è¯´æ˜ |
|------|------|------|---------|
| v1.0 | 2026-02-01 | AI Code Review | åˆå§‹ç‰ˆæœ¬ |

---

**æŠ¥å‘Šå®Œæˆæ—¥æœŸ**: 2026-02-01
**ä¸‹æ¬¡å®¡è®¡æ—¶é—´**: 2026-05-01 (3 ä¸ªæœˆå)
